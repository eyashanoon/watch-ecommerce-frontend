<!-- Background video -->
<video #videoRef autoplay loop playsinline [attr.muted]="" class="background-video">
  <source src="/assets/ad.mp4" type="video/mp4" />
  Your browser does not support the video tag.
</video>

<!-- Dark overlay -->
<div class="overlay"></div>


 
<div style="height: 100px;"></div> <!-- spacer -->

<div class="profile-container">
      <!-- TOAST CONTAINER -->
  <div class="toast-container" *ngIf="showToast">
    <div class="toast show">
      {{ toastMessage }}
    </div>
  </div>
  <h2>Your Profile</h2>

  <!-- Loading -->
  <p *ngIf="loading">Loading profile...</p>

  <!-- Error -->
  <p *ngIf="errorMsg" class="error-msg">{{ errorMsg }}</p>

  <!-- View Mode -->
  <div *ngIf="user && !editMode && !loading">
    <p><strong>Full Name:</strong> {{ user.username }}</p>
    <p><strong>Email:</strong> {{ user.email }}</p>
    <p><strong>Phone Number:</strong> {{ user.phone }}</p>
    <!-- Password NOT shown in view mode -->
    <p><strong>Role:</strong> {{ user.roles }}</p>

    <button (click)="enterEditMode()">✏️ Edit</button>
<button (click)="deleteAccount()" style="margin-left: 10px;">🗑️ Delete Account</button>
  </div>

  <!-- Edit Mode -->
  <div *ngIf="user && editMode && !loading">
    <label>
      <strong>Full Name:</strong>
      <input [(ngModel)]="editableUser.username" />
    </label>
    <br />



    <label>
      <strong>Phone Number:</strong>
      <input [(ngModel)]="editableUser.phone" />
    </label>
    <br />

    <!-- Change Password button, shown only if NOT editing password -->
    <div *ngIf="!editingPassword" style="margin-bottom: 10px;">
      <button
        type="button"
        class="change-password-btn"
        (click)="editingPassword = true"
      >
        Change Password
      </button>
    </div>

    <!-- Password inputs, shown only when editingPassword = true -->
    <div *ngIf="editingPassword">
      <label
        class="password-wrapper"
        style="display: flex; align-items: center; gap: 8px;"
      >
        <strong>Password:</strong>
        <input
          [type]="showPassword ? 'text' : 'password'"
          [(ngModel)]="editableUser.password"
          style="flex: 1;"
        />
        <span
          class="eye-icon"
          [class.visible]="showPassword"
          (click)="showPassword = !showPassword"
          style="cursor: pointer;"
          title="Toggle Password Visibility"
        >
          👁️‍🗨️
          <span class="slash" *ngIf="showPassword"></span>
        </span>
      </label>
      <br />

      <label
        class="password-wrapper"
        style="display: flex; align-items: center; gap: 8px;"
      >
        <strong>Confirm Password:</strong>
        <input
          [type]="showConfirmPassword ? 'text' : 'password'"
          [(ngModel)]="editableUser.confirmPassword"
          style="flex: 1;"
        />
        <span
          class="eye-icon"
          [class.visible]="showConfirmPassword"
          (click)="showConfirmPassword = !showConfirmPassword"
          style="cursor: pointer;"
          title="Toggle Confirm Password Visibility"
        >
          👁️‍🗨️
          <span class="slash" *ngIf="showConfirmPassword"></span>
        </span>
      </label>
      <br />

      <button
        type="button"
        class="cancel-password-btn"
        (click)="cancelPasswordEdit()"
      >
        Cancel Password Change
      </button>
    </div>

     <button (click)="saveChanges()">💾 Save</button>
 
    <button (click)="cancelEdit()" style="margin-left: 10px;">❌ Cancel</button>

  </div>

  <!-- Fallback -->
  <div *ngIf="!user && !loading && !errorMsg">
    <p>No user information available.</p>
  </div>
</div>
<button (click)="showPaymentInfo = !showPaymentInfo">
  {{ showPaymentInfo ? 'Hide Payment Info' : 'Show Payment Info' }}
</button>
<!-- Payment Card Section -->
<div class="card-container" *ngIf="showPaymentInfo">
  <h2>Payment Information</h2>

  <!-- Card Details -->
  <div *ngIf="myCard && myCard.cardNumber">
    <p><strong>Card Type:</strong> {{ myCard.cardType }}</p>
    <p><strong>Card Holder:</strong> {{ myCard.cardHolderName }}</p>
    <p><strong>Card Number:</strong> {{ myCard.cardNumber}}</p>
    <p><strong>Expiration Date:</strong> {{ myCard.expirationDate }}</p>
    <p><strong>CVV:</strong> {{myCard.cvv}}</p>
    <!--<button (click)="updateCardInfo()">Update Card</button>-->
  </div>

  <!-- Create New Card Form -->
<div *ngIf="!createdCrd" style="margin-top: 15px;">
  <h4>Add a New Card</h4>
<label>Card Type:
  <select [(ngModel)]="myCard.cardType">
    <option value="">-- Select Card Type --</option>
    <option *ngFor="let type of cardTypes" [value]="type">{{ type }}</option>
  </select>
</label><br />
  <label>Card Holder Name: <input [(ngModel)]="myCard.cardHolderName" /></label><br />
  <label>Card Number: <input [(ngModel)]="myCard.cardNumber" /></label><br />
  <label>Expiration Date: <input [(ngModel)]="myCard.expirationDate" placeholder="MM/YY" /></label><br />
  <label>CVV: <input [(ngModel)]="myCard.cvv" /></label><br />
  <label>Billing Address: <input [(ngModel)]="myCard.billingAddress" /></label><br />
  <label>Postal Code: <input [(ngModel)]="myCard.postalCode" /></label><br />
  <button (click)="createNewCard()">Create Card</button>
</div>
</div>

